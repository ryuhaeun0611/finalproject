import streamlit as st
from pathlib import Path

# -------------------------------------------
# 기본 설정
# -------------------------------------------
st.set_page_config(
    page_title="숲가꾸기와 산불 피해",
    layout="wide"
)

st.title("🌲 숲가꾸기 활동이 산불 피해에 미치는 영향")

# -------------------------------------------
# 앱 제작자
# -------------------------------------------
st.markdown("""
### 👥 앱 제작자  
**동덕여자고등학교 20908 류지민 · 20909 류하은 · 20923 최보경**
""")

st.markdown("----")

# -------------------------------------------
# 한 줄 요약 (기본 강조형)
# -------------------------------------------
st.markdown("""
### 🔍 한 줄 요약

최근 연구들은 **숲가꾸기·조림 활동이 오히려 산불 발생 횟수와 피해 규모를 증가시킬 수 있다**는 가능성을 보여줍니다.  
특히 하층식생 제거로 인한 건조화가 산불을 더욱 빠르게 확산시키는 핵심 요인으로 지목됩니다.
""")

st.markdown("----")

# -------------------------------------------
# 연구 요약
# -------------------------------------------
st.markdown("""
## 1️⃣ 무엇을 근거로 말하나?

### 🧪 연구 1. 강릉 난곡동 대형산불(2023) 사례 분석
- 피해 산림 면적: **약 149ha**
- 피해지 경계 50m 이내 도로 길이: **약 59.6km**
- 도로 밀도: **168.9 m/ha (전국 평균 대비 40배 이상)**
- 도로에 의해 분절된 숲 **83개 패치 전부 전소**
- 넓은 도로·하천·제방도 **비산(ember spotting)** 때문에 방화선 역할 실패  
→ **도로망이 대형산불 확산을 막지 못함**

---

### 🧪 연구 2. 경상북도 1km 격자 산불 274건 통계 분석
- 숲가꾸기·조림 비율 ↑ → 산불 발생 확률 ↑ (유의)
- 침엽수 비율, 임분 밀도 ↑ → 위험 증가
- 상대습도, 숲의 나이 ↑ → 위험 감소
- 임도 접근성 → 유의하지 않음  

👉 **산불은 임도보다 숲 구조(숲가꾸기·조림, 침엽수 편중, 임분 밀도 등)의 영향을 훨씬 더 크게 받는다**는 결과입니다.
""")

st.markdown("----")

# -------------------------------------------
# 메커니즘 요약
# -------------------------------------------
st.markdown("""
## 2️⃣ 왜 이런 일이 벌어질까? (메커니즘)

### 🌿 1. 숲가꾸기 → 하층식생 제거 → 숲 내부 습도 감소
- 하층식생(활엽수·관목·풀)은 토양 수분 유지, 그늘 형성, 연료 분절 기능을 합니다.
- 숲가꾸기로 이 층이 제거되면
  - 햇빛·바람이 지면까지 바로 도달 → 낙엽·토양 **급속 건조**
  - 균질한 연료층이 형성되어 **발화·확산이 쉬운 숲 구조**가 됩니다.

---

### 🌲 2. 침엽수 편중 + 높은 임분 밀도
- 침엽수는 기름 성분과 낙엽 특성 때문에 **가연성이 높고**,
- 나무 사이 간격이 촘촘하면 수관이 이어져 **수관화(위에서 타는 불)** 로 발전하기 쉽습니다.
- 숲가꾸기가 이 구조를 충분히 바꾸지 못하면  
  → **‘정돈된 고연료 숲’**만 남게 됩니다.

---

### 🛣️ 3. 도로·임도의 한계
- 강풍·대형산불 상황에서는 비산(ember)이 수십~수백 m를 날아
  넓은 도로·하천·제방까지 쉽게 넘어갑니다.
- 통계적으로도 임도 접근성은 산불 발생과 **유의한 상관이 거의 없음**이 확인되었습니다.

👉 결과적으로, **현재 방식의 숲가꾸기 활동이 산불 위험을 줄이기보다 높이는 방향으로 작용할 수 있다**는 점을 시사합니다.
""")

st.markdown("----")

# -------------------------------------------
# 앱 구성 안내
# -------------------------------------------
st.markdown("""
## 3️⃣ 이 앱에서 볼 수 있는 것 👀

- **[다중 변수 기반 산불 피해 시뮬레이션]**  
  → 숲가꾸기 밀도, 침엽수 비율, 임분 밀도, 습도, 경사도 등을 바꾸어 보며  
    산불 피해 면적이 어떤 방향으로 달라지는지 실험해 볼 수 있습니다.

👉 왼쪽 **탭(Pages)** 메뉴에서 *“다중 변수 기반 산불 피해 예측 시뮬레이션”* 페이지를 선택하세요.
""")

st.markdown("----")

# -------------------------------------------
# PDF 다운로드 기능
# -------------------------------------------
st.markdown("## 📄 참고한 연구자료 직접 보기")

BASE_DIR = Path(__file__).parent

def pdf_download_button(rel_path: str, title: str):
    """PDF 다운로드 버튼만 제공하는 함수"""
    pdf_path = BASE_DIR / rel_path

    st.subheader(title)
    st.caption(f"`{rel_path}` 파일을 불러옵니다.")

    if not pdf_path.exists():
        st.error(f"⚠ `{rel_path}` 파일이 존재하지 않습니다.")
        return

    with pdf_path.open("rb") as f:
        pdf_bytes = f.read()

    st.download_button(
        label="📥 PDF 다운로드해서 보기",
        data=pdf_bytes,
        file_name=pdf_path.name,
        mime="application/pdf",
        key=f"download_{pdf_path.name}"
    )

col1, col2 = st.columns(2)

with col1:
    pdf_download_button(
        "pdf/road_fire.pdf",
        "🔍 연구 1: 산림 내 도로 확대와 대형산불"
    )

with col2:
    pdf_download_button(
        "pdf/forest_road_fire.pdf",
        "🌲 연구 2: 임도·산림경영이 산불 발생에 미치는 영향"
    )
