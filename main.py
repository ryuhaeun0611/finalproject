import streamlit as st
from pathlib import Path

# ---------------------------------------------------------
# 기본 설정
# ---------------------------------------------------------
st.set_page_config(
    page_title="숲가꾸기와 산불 위험",
    layout="wide"
)

st.title("🌲 숲가꾸기 활동이 산불 피해에 미치는 영향")

# ---------------------------------------------------------
# 👥 앱 제작자
# ---------------------------------------------------------
st.markdown("""
### 👥 앱 제작자  
**동덕여자고등학교 20908 류지민 · 20909 류하은 · 20923 최보경**
""")

st.markdown("---")

# ---------------------------------------------------------
# 🔍 한 줄 요약 (기본 강조형)
# ---------------------------------------------------------
st.markdown("""
### 🔍 한 줄 요약

**숲가꾸기 사업은 원래 산불·재해를 줄이고 건강한 숲을 만드는 것을 목표로 하지만,  
최근 연구에 따르면 특정 조건에서는 오히려 산불 발생 위험과 피해 규모를 **증가시킬 가능성**도 있다고 합니다.**
""")

st.markdown("---")

# ---------------------------------------------------------
# 1️⃣ 숲가꾸기 사업이란? (배경이론)
# ---------------------------------------------------------
st.markdown("""
## 1️⃣ 숲가꾸기 사업이란? 🌳

산림청의 설명에 따르면, **숲가꾸기 사업**은  
조림지와 천연림이 **건강하고 우량한 숲**으로 자라도록  
나무의 밀도와 생장을 인위적으로 조절하는 대표적인 산림 관리 정책입니다.

주요 내용은 대략 다음과 같습니다.

- **어린나무가꾸기**  
  - 나무를 심은 뒤 5~10년 동안 자라지 못하는 나무, 병든 나무, 비뚤어진 나무 등을 솎아내어  
    잘 자라는 나무에 더 많은 공간과 양분을 주는 작업

- **가지치기(가지치기·전지)**  
  - 줄기 아래쪽의 가지나 죽은 가지를 잘라내어  
    옹이를 줄이고 곧고 질 좋은 목재를 생산하도록 하는 작업

- **솎아베기(간벌)**  
  - 너무 빽빽하게 자란 숲에서 일부 나무를 베어  
    남은 나무의 생장 공간을 확보하고, 숲의 구조를 개선하는 작업

- **천연림가꾸기**  
  - 자연적으로 자란 숲에서 노쇠·훼손된 나무를 제거하고  
    건강한 나무를 중심으로 숲의 구조를 정리하는 작업

이론적으로는 다음과 같은 효과를 기대합니다.

- 목재 생산성 향상  
- 수원 함양, 토사 유출 방지 등 산림의 공익 기능 강화  
- 숲의 건강성·안정성 향상  
- 장기적으로 산불·병해충에 대한 저항성 증가  

그래서 오랫동안 **“숲가꾸기 = 좋은 관리 = 산불 위험 감소”** 라는  
공식처럼 이해되어 온 측면이 있습니다.
""")

st.markdown("---")

# ---------------------------------------------------------
# 2️⃣ 그러나, 숲가꾸기가 항상 안전을 보장할까? (문제 제기)
# ---------------------------------------------------------
st.markdown("""
## 2️⃣ 그러나, 숲가꾸기가 항상 안전을 보장할까? 🔥

최근 국내 산불 관련 연구와 실제 대형산불 사례를 보면,  
숲가꾸기가 **항상 산불을 줄이는 방향으로만 작동하지는 않는다**는  
문제가 제기되고 있습니다.

### 📌 문제 제기의 핵심

1. **침엽수 위주의 조림 + 강한 솎아베기·간벌**
   - 침엽수가 넓게, 빽빽하게 이어진 숲 구조가 만들어짐  
   - 수관과 하층 연료가 **연속된 ‘연료 카펫’**처럼 이어져  
     불이 붙으면 멀리·빠르게 번질 수 있는 조건이 형성됨

2. **하층 활엽수·관목 제거 → 숲 바닥 건조화**
   - 숲가꾸기 과정에서 하층식생이 크게 줄어들면  
     그늘이 사라지고, 바람이 더 잘 통하면서  
     숲 바닥(낙엽·가지·풀)이 **쉽게 마르는 구조**가 됨  
   - 특히 봄철 건조기에는 마른 낙엽과 가지들이  
     **넓게·균질하게 깔린 산불 연료층**이 될 수 있음

3. **임도·도로망 확대의 한계**
   - 기존 정책은 “임도·도로가 많으면 진입·진화가 쉬워져 산불 확산을 막을 수 있다”고 보았지만,  
     실제 대형산불 사례(예: 강릉 난곡 일대 산불)를 보면  
     넓은 도로·하천·제방으로 나뉜 숲 패치들까지  
     **비산(ember, 불씨 날림)** 으로 대부분 전소된 사례가 보고되었습니다.
   - 통계 분석 결과에서도,  
     **임도 접근성 변수는 산불 발생과 통계적으로 뚜렷한 상관을 보이지 않는 경우**가 많습니다.

---

요약하면,

> “어디에, 어떤 수종으로, 어떤 강도의 숲가꾸기를 했는가”에 따라  
> 숲가꾸기가 산불을 줄이기도 하고,  
> **오히려 산불에 취약한 구조를 만들 수도 있다**는 것이  
> 최근 연구들에서 제기하는 핵심 문제입니다.
""")

st.markdown("---")

# ---------------------------------------------------------
# 3️⃣ 이 앱에서 무엇을 볼 수 있나? 👀
# ---------------------------------------------------------
st.markdown("""
## 3️⃣ 이 앱에서 무엇을 볼 수 있나? 👀

이 웹앱은 위 문제의식을 바탕으로,  
**숲가꾸기 밀도와 산불 피해의 관계를 ‘직접 조작하면서’ 살펴볼 수 있도록** 구성되었습니다.

1. **[숲가꾸기와 산불 위험 시뮬레이터] 페이지**  
   - 숲가꾸기/조림 밀도, 수관 밀도, 임분 밀도, 침엽수 비율, 경사도, 습도 등을 조절해 보며  
     산불 **피해 면적 예측값**이 어떻게 변하는지 시각적으로 확인합니다.  
   - 특히 **“숲가꾸기/조림 밀도가 높아질수록 피해가 커지는지”**를  
     회귀선과 SHAP(변수 영향력) 분석으로 직관적으로 볼 수 있습니다.

2. **[실제 연구 자료 CSV 열람] 섹션**  
   - 과거 10년간 산불 통계(연도별·지역별),  
     임도시설 현황 등 **실제 공공 데이터**를  
     앱 안에서 바로 표 형태로 확인하고,  
     CSV 파일로도 내려받을 수 있습니다.

👉 왼쪽 **Pages 메뉴**에서  
`숲가꾸기와 산불 위험 시뮬레이터` 페이지를 선택해  
직접 값을 바꾸어 보면서 체험해 보세요.
""")

st.markdown("---")

# ---------------------------------------------------------
# 4️⃣ 참고한 연구자료 직접 보기 📄
# ---------------------------------------------------------
st.markdown("## 4️⃣ 참고한 연구자료 직접 보기 📄")

BASE_DIR = Path(__file__).parent
PDF_DIR = BASE_DIR / "pdf"

def add_pdf_download_button(rel_path: str, label: str):
    pdf_path = PDF_DIR / rel_path
    if not pdf_path.exists():
        st.warning(f"`{rel_path}` 파일을 pdf 폴더에서 찾을 수 없습니다. (리포지토리 경로를 다시 확인해 주세요.)")
        return

    with open(pdf_path, "rb") as f:
        pdf_bytes = f.read()

    st.download_button(
        label=label,
        data=pdf_bytes,
        file_name=pdf_path.name,
        mime="application/pdf",
    )

col1, col2 = st.columns(2)

with col1:
    st.subheader("🔍 연구 1: 산림 내 도로의 확대는 대형산불을 막을 수 있는가")
    st.caption("`pdf/산림 내 도로의 확대는 대형산불을 막을 수 있는가.pdf` 파일을 기반으로 요약했습니다.")
    add_pdf_download_button(
        "산림 내 도로의 확대는 대형산불을 막을 수 있는가.pdf",
        "📥 PDF 다운로드해서 보기"
    )

with col2:
    st.subheader("🌲 연구 2: 임도와 산림경영이 산불 발생에 미치는 영향")
    st.caption("`pdf/임도와 산림경영이 산불 발생에 미치는 영향.pdf` 파일을 기반으로 요약했습니다.")
    add_pdf_download_button(
        "임도와 산림경영이 산불 발생에 미치는 영향.pdf",
        "📥 PDF 다운로드해서 보기"
    )

st.markdown("---")

st.caption("※ 이 메인 페이지는 숲가꾸기 정책의 배경과 한계를 소개하고, 다른 페이지에서의 시뮬레이션과 데이터 탐색으로 이어지는 ‘입구’ 역할을 합니다.")
